import 'package:flutter/material.dart';import 'package:flutter/widgets.dart';import 'package:fluttertoast/fluttertoast.dart';import 'package:truth_ordare/models/user.dart';import 'package:truth_ordare/strings/color.dart';import 'package:truth_ordare/helpers/dbhelper.dart';import 'package:sqflite/sqflite.dart';import 'dart:async';import "dart:math";class Home extends StatefulWidget {  @override  _HomeState createState() => _HomeState();}class _HomeState extends State<Home> {  String hasilRandom = '';  String nama;  TextEditingController nameController = TextEditingController();  DbHelper dbHelper = DbHelper();  int count = 0;  List<User> userList;  @override  Widget build(BuildContext context) {    if (userList == null) {      userList = List<User>();    }    return Scaffold(      body: SingleChildScrollView(child: Column(        children: <Widget>[          Container(            margin: EdgeInsets.only(top: 48),            child: Row(              children: <Widget>[                Container(                    child: Expanded(                        child: Container(                            margin: EdgeInsets.only(left: 90),                            alignment: Alignment.center,                            child: Text(                              'Truth or Dare',                              style: TextStyle(                                  fontWeight: FontWeight.bold, fontSize: 24),                            )))),                Container(                  margin: EdgeInsets.only(right: 10),                  child: IconButton(                    icon: Icon(                      Icons.account_circle,                      color: hitam,                    ),                    onPressed: null,                  ),                ),              ],            ),          ),          Divider(),          Container(            padding: EdgeInsets.all(16),            child: Text('Masukkan Nama Kamu :',                style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold)),          ),          Column(            children: <Widget>[              Container(                margin: EdgeInsets.only(top: 10, right: 10, left: 10),                child: TextField(                  controller: nameController,                  keyboardType: TextInputType.text,                  decoration: InputDecoration(                    contentPadding: EdgeInsets.fromLTRB(50.0, 15.0, 20.0, 15.0),                    border: OutlineInputBorder(),                    prefixIcon: Icon(Icons.account_circle),                    labelText: 'Nama Kamu ',                  ),                  // onChanged: (),                ),              ),              RaisedButton(                child: Text(                  'Masukkan',                  style: TextStyle(fontSize: 20, color: hitam),                ),                onPressed: () async {                  if (nameController.text == '') {                    Fluttertoast.showToast(                        msg: "Nama Kamu Kosong",                        toastLength: Toast.LENGTH_SHORT,                        gravity: ToastGravity.CENTER,                        timeInSecForIos: 1,                        backgroundColor: Colors.red,                        textColor: Colors.white,                        fontSize: 16.0);                    nameController.text = '';                    print('tombol di tekan');                  } else {                    var ada = false;                    var i = 0;                    print('nama controller :' + nameController.text);                    while (i < userList.length) {                      print(userList.length);                      print('nama isi:' + this.userList[i].name);                      if (nameController.text == this.userList[i].name) {                        ada = true;                      }                      i++;                    }                    if (!ada) {                      await addUser(User(nameController.text, 0));                      nameController.text = '';                    } else {                      Fluttertoast.showToast(                          msg: "Nama Sama",                          toastLength: Toast.LENGTH_SHORT,                          gravity: ToastGravity.CENTER,                          timeInSecForIos: 1,                          backgroundColor: Colors.red,                          textColor: Colors.white,                          fontSize: 16.0);                    }                  }                },              ),            ],          ),          Container(            margin: EdgeInsets.only(top: 20),            child: Text(              'Daftar : ',              style: TextStyle(fontSize: 16, fontWeight: FontWeight.bold),            ),          ),          Container(            height: 200,            margin: EdgeInsets.only(left: 50, right: 50),            //decoration: BoxDecoration( borderRadius: ),            child: Scrollbar(              child: ListView.builder(                shrinkWrap: true,                itemBuilder: (context, index) {                  return Card(                    child: Container(                      margin: EdgeInsets.all(10),                      child: Row(                        mainAxisAlignment: MainAxisAlignment.start,                        children: <Widget>[                          Expanded(                              child: Container(                            margin: EdgeInsets.only(left: 5),                            child: Text((index + 1).toString() +                                ' : ' +                                this.userList[index].name),                          )),                          Container(                            child: InkWell(                              child: Icon(Icons.delete),                              onTap: () {                                deleteUser(userList[index]);                              },                            ),                          ),                        ],                      ),                    ),                  );                },                itemCount: this.userList.length,              ),            ),          ),          RaisedButton(            child: Text(              'Random',              style: TextStyle(fontSize: 20, color: hitam),            ),            onPressed: (){              final _random = new Random();              setState(() {                hasilRandom = userList[_random.nextInt(userList.length)].name;              });            },          ),          Container(            margin: EdgeInsets.only(top: 10),            child: Row(              mainAxisAlignment: MainAxisAlignment.center,              children: <Widget>[                Container(child: Text('Kamu main : ', style: TextStyle(fontWeight: FontWeight.bold,fontSize: 13),),),                Container(                  child: Text(                      hasilRandom , style: TextStyle(fontWeight: FontWeight.bold,fontSize: 13),                  ),                ),              ],            ),          ),        ],      )),    );  }  //TAMBAH USER  Future<bool> addUser(User object) async {    int result = await dbHelper.insert(object);    if (result > 0) {      updateListView();      return true;    }    return false;  }  // EDIT USER  void editUser(User object) async {    int result = await dbHelper.update(object);    if (result > 0) {      updateListView();    }  }  // DELETE USER  void deleteUser(User object) async {    int result = await dbHelper.delete(object.id);    if (result > 0) {      updateListView();    }  }// UPDATE USER  void updateListView() {    final Future<Database> dbFuture = dbHelper.initDb();    dbFuture.then((database) {      Future<List<User>> userListFuture = dbHelper.getUserList();      userListFuture.then((userList) {        setState(() {          this.userList = userList;          this.count = userList.length;        });      });    });  }}